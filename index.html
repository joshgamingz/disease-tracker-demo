<html>
<head>
    <link rel="stylesheet" href="style.css">
    <title>Navigation bar</title>
    <meta charset="utf-8">
    <meta name="author" content="anonymous">
    <meta name="generator" content="Sublime text3">
    <meta name="robot" content="index, follow">
    <meta http-equiv="refresh" content="">
    <meta name="description" content="This is navigation bar on html page">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keyowrds" content="html, navigation bar, navigation, bar, javascript, content">
</head>
<body>
<div id="weather-widget">
    <p>Loading weather...</p>
</div>
<p>

<div class="map-container">

    <div class="pin"></div>

    <img src="QCDISTRICT 5.png" class="qcd5" alt="Map">

</div>
<div class="map2-container">
    <div class="D6pin"></div>

    <img src="QCDISTRICT 6.png" class="qcd6" alt="Map">
</div>
<div class="map3-container">
    <div class="D1pin"></div>

    <img src="QCDISTRICT 1.png" class="qcd1" alt="Map">
</div>
<div class="map4-container">
    <div class="D4pin"></div>

    <img src="QCDISTRICT 4.png" class="qcd4" alt="Map">
</div>
</div>
<div class="map5-container">
    <div class="D3pin"></div>

    <img src="QCDISTRICT 3.png" class="qcd3" alt="Map">
</div>
<div class="html-container">
    <div class="html-section">
        <div class="html-project">
            <div class="navigation">
                <nav>
                    <ul class="nav-type">
                        <li><a href="home.html"  class="active">Home</a></li>
                        <li><a href="index.html"  class="active">Map</a></li>
                        <li><a href="dashboard.html" target="_blank" class="active1">Dashboard</a></li>
                        <li><a href="report.html" target="_blank" class="active2">Forms</a></li>
                        <li><a href="education.html"  class="active3">Education</a></li>

                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <noscript>
        <div class="first-line">
            <div class="linear">
                <div class="line-w5">

                </div>
            </div>
        </div>
    </noscript>
    <template>
        <div class="flash-fluid">
            <div class="flash-time">
                <div class="flash-GIF">

                </div>
            </div>
        </div>
    </template>
    <noscript>
        <div class="cyrcle-center">
            <div class="radial-cyrcle">

            </div>
        </div>
    </noscript>
</div>
<template>
    <div class="text-class">
        <div class="text-container">
            <div class="text-content-fluid" id="chinese-text" data-text-type="chinese">
                <div class="chinese-text">設</div>
                <div class="chinese-text2">計</div>
                <div class="chinese-text3">和</div>
                <div class="chinese-text4">開</div>
                <div class="chinese-text5">發</div>
            </div>
        </div>
    </div>
</template>

<div class="dropdown" id="anotherFunction">
    <div class="drop1">HTML</div>
    <div class="drop2">CSS</div>
    <div class="drop3">Javascript</div>
    <div class="drop4">Sass</div>

    <script>
        // [12.8797, 121.7740] is the center of the Philippines
    var map = L.map('map').setView([12.8797, 121.7740], 6);

    // This adds the map "tiles" (the actual map image)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
    }).addTo(map);
    </script>
    <script>
        // Ask Member 2 for the URL. It will be 'http://localhost:3000/get-cases'
        fetch('http://localhost:3000/get-cases')
            .then(response => response.json())
            .then(cases => {
                // Loop through each case from the JSON file
                cases.forEach(c => {
                    // Add a marker (red dot)
                    L.marker([c.lat, c.lng]).addTo(map)
                        .bindPopup(`<b>${c.disease}</b><br>${c.cases} cases reported.`);
                });
            });
    </script>



    <script>
        // Wait for the page to fully load
        window.addEventListener('load', () => {

            // --- IMPORTANT: REPLACE WITH YOUR OWN API KEY ---
            const apiKey = "5dbf2a2a3d8b222dfe13b06ca94e8356";
            // ------------------------------------------------

            const widget = document.getElementById('weather-widget');

            // Function to fetch weather data from OpenWeatherMap
            // It can be called with coordinates or a default city
            function fetchWeather(lat, lon, city) {
                let url;
                if (lat && lon) {
                    // Use coordinates if available
                    url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`;
                } else {
                    // Fallback to a default city (Manila)
                    url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
                }

                widget.innerHTML = '<p>Loading weather...</p>'; // Show loading message

                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Weather data not found');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // We have the data! Now update the widget's HTML
                        const temp = Math.round(data.main.temp);
                        const city = data.name;
                        const description = data.weather[0].description;
                        const iconCode = data.weather[0].icon;
                        const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                        widget.innerHTML = `
                    <h4>${city}</h4>
                    <img src="${iconUrl}" alt="${description}" class="weather-icon">
                    <div class="temp">${temp}°C</div>
                    <div class="description">${description}</div>
                `;
                    })
                    .catch(error => {
                        console.error('Error fetching weather:', error);
                        widget.innerHTML = `<p>Could not load weather. ${error.message}</p>`;
                    });
            }

            // --- Geolocation Logic ---
            if (navigator.geolocation) {
                // (Success) User allowed location
                const successCallback = (position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    fetchWeather(lat, lon);
                };

                // (Error) User blocked or an error occurred
                const errorCallback = (error) => {
                    console.warn(`Geolocation error (${error.code}): ${error.message}`);
                    widget.innerHTML = '<p>Location blocked. Showing default weather.</p>';
                    // Fallback to default city
                    fetchWeather(null, null, 'Manila');
                };

                // Ask the browser for the location
                navigator.geolocation.getCurrentPosition(successCallback, errorCallback);

            } else {
                // Geolocation is not supported by this browser
                widget.innerHTML = '<p>Geolocation not supported. Showing default weather.</p>';
                // Fallback to default city
                fetchWeather(null, null, 'Manila');
            }
        });
        </script>
</body>
</html>


</body>
</html>