<html>
<head>
    <link rel="stylesheet" href="style.css">
    <title>Navigation bar</title>
    <meta charset="utf-8">
    <meta name="author" content="anonymous">
    <meta name="generator" content="Sublime text3">
    <meta name="robot" content="index, follow">
    <meta http-equiv="refresh" content="">
    <meta name="description" content="This is navigation bar on html page">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keyowrds" content="html, navigation bar, navigation, bar, javascript, content">

</head>

<body>
<div class="html-container">
    <div class="html-section">
        <div class="html-project">
            <div class="navigation">
                <nav>
                    <ul class="nav-type">
                        <li><a href="home.html"  class="active">Home</a></li>
                        <li><a href="index.html"  class="active">Map</a></li>
                        <li><a href="dashboard.html"  class="active1">Dashboard</a></li>
                        <li><a href="report.html"  class="active2">Forms</a></li>
                        <li><a href="education.html"  class="active3">Education</a></li>

                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <noscript>
        <div class="first-line">
            <div class="linear">
                <div class="line-w5">

                </div>
            </div>
        </div>
    </noscript>
    <template>
        <div class="flash-fluid">
            <div class="flash-time">
                <div class="flash-GIF">

                </div>
            </div>
        </div>
    </template>
    <noscript>
        <div class="cyrcle-center">
            <div class="radial-cyrcle">

            </div>
        </div>
    </noscript>
</div>
<div id="weather-widget">
    <p>Loading weather...</p>
</div>
<p>

<div id="map-container-responsive">

    <div id="map-canvas">

        <div class="district-box" id="d5">
            <div class="map-pin"></div> <img src="QCDISTRICT 5.png" alt="District 5">
        </div>

        <div class="district-box" id="d6">
            <div class="map-pin"></div> <img src="QCDISTRICT 6.png" alt="District 6">
        </div>

        <div class="district-box" id="d1">
            <div class="map-pin"></div> <img src="QCDISTRICT 1.png" alt="District 1">
        </div>

        <div class="district-box" id="d4">
            <div class="map-pin"></div> <img src="QCDISTRICT 4.png" alt="District 4">
        </div>

        <div class="district-box" id="d3">
            <div class="map-pin"></div> <img src="QCDISTRICT 3.png" alt="District 3">
        </div>
        <div class="district-box" id="d2">
            <div class="map-pin"></div> <img src="QCDISTRICT 2.png" alt="District 2">
            <div class="district-box" id="mnld3">
                <div class="map-pin"></div> <img src="MNLDISTRICT 3.png" alt="Manila District 3">
    </div>
            <div class="district-box" id="mnld4">
                <div class="map-pin"></div> <img src="MNLDISTRICT 4.png" alt="Manila District 4">
            </div>
            <div class="district-box" id="mnld1">
                <div class="map-pin"></div> <img src="MNLDISTRICT 1.png" alt="Manila District 1">
            </div>
            <div class="district-box" id="mnld2">
                <div class="map-pin"></div> <img src="MNLDISTRICT 2.png" alt="Manila District 2">
            </div>
            <div class="district-box" id="mnld5">
                <div class="map-pin"></div> <img src="MNLDISTRICT 5.png" alt="Manila District 5">
            </div>
            <div class="district-box" id="mnld6">
                <div class="map-pin"></div> <img src="MNLDISTRICT 6.png" alt="Manila District 6">
            </div>
</div>

<template>
    <div class="text-class">
        <div class="text-container">
            <div class="text-content-fluid" id="chinese-text" data-text-type="chinese">
                <div class="chinese-text">設</div>
                <div class="chinese-text2">計</div>
                <div class="chinese-text3">和</div>
                <div class="chinese-text4">開</div>
                <div class="chinese-text5">發</div>
            </div>
        </div>
    </div>
</template>




    <script>
        // [12.8797, 121.7740] is the center of the Philippines
    var map = L.map('map').setView([12.8797, 121.7740], 6);

    // This adds the map "tiles" (the actual map image)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
    }).addTo(map);
    </script>
    <script>
        // Ask Member 2 for the URL. It will be 'http://localhost:3000/get-cases'
        fetch('http://localhost:3000/get-cases')
            .then(response => response.json())
            .then(cases => {
                // Loop through each case from the JSON file
                cases.forEach(c => {
                    // Add a marker (red dot)
                    L.marker([c.lat, c.lng]).addTo(map)
                        .bindPopup(`<b>${c.disease}</b><br>${c.cases} cases reported.`);
                });
            });
    </script>
    <script>
        const container = document.getElementById('map-container-responsive');
        const canvas = document.getElementById('map-canvas');

        // Variables to track position and zoom
        let currentScale = 1;
        let isDragging = false;
        let startX, startY;
        let translateX = 0, translateY = 0;

        // 1. INITIAL SETUP: Fit map to screen on load
        function fitToScreen() {
            const canvasStyle = window.getComputedStyle(canvas);
            const originalWidth = parseInt(canvasStyle.width);
            const originalHeight = parseInt(canvasStyle.height); // Get the map's true height

            // Calculate the scale needed to fit the screen
            const scaleFactor = container.offsetWidth / originalWidth;

            // Set the starting values
            currentScale = scaleFactor;
            translateX = 0;
            translateY = 0;

            updateTransform();

            // --- THE FIX IS HERE ---
            // We multiply the original height (900px) by the scale (e.g., 0.5)
            // This tells the container exactly how tall the map is right now.
            container.style.height = `${originalHeight * scaleFactor}px`;
        }

        // 2. THE MOVEMENT LOGIC (Apply the math)
        function updateTransform() {
            // We move (translate) first, then zoom (scale)
            canvas.style.transform = `translate(${translateX}px, ${translateY}px) scale(${currentScale})`;
        }

        // 3. ZOOM FEATURE (Mouse Wheel)
        container.addEventListener('wheel', (e) => {
            e.preventDefault(); // Stop the whole page from scrolling

            const zoomSpeed = 0.05; // Adjust this to make zoom faster/slower

            if (e.deltaY < 0) {
                // Scroll Up = Zoom In
                currentScale += zoomSpeed;
            } else {
                // Scroll Down = Zoom Out
                currentScale -= zoomSpeed;
            }

            // Optional: Prevent zooming out too far (smaller than screen)
            if (currentScale < 0.2) currentScale = 0.2;

            updateTransform();
        });

        // 4. PAN FEATURE (Click and Drag)

        // Start Dragging
        container.addEventListener('mousedown', (e) => {
            isDragging = true;
            canvas.style.cursor = 'grabbing';

            // Record where we started clicking relative to the current movement
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
        });

        // Stop Dragging
        window.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'grab';
        });

        // Move Dragging
        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            e.preventDefault();

            // Calculate new position
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;

            updateTransform();
        });

        // Run setup on load and resize
        window.addEventListener('load', fitToScreen);
        window.addEventListener('resize', fitToScreen);
    </script>


    <script>
        // Wait for the page to fully load
        window.addEventListener('load', () => {

            // --- IMPORTANT: REPLACE WITH YOUR OWN API KEY ---
            const apiKey = "5dbf2a2a3d8b222dfe13b06ca94e8356";
            // ------------------------------------------------

            const widget = document.getElementById('weather-widget');

            // Function to fetch weather data from OpenWeatherMap
            // It can be called with coordinates or a default city
            function fetchWeather(lat, lon, city) {
                let url;
                if (lat && lon) {
                    // Use coordinates if available
                    url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`;
                } else {
                    // Fallback to a default city (Manila)
                    url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
                }

                widget.innerHTML = '<p>Loading weather...</p>'; // Show loading message

                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Weather data not found');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // We have the data! Now update the widget's HTML
                        const temp = Math.round(data.main.temp);
                        const city = data.name;
                        const description = data.weather[0].description;
                        const iconCode = data.weather[0].icon;
                        const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                        widget.innerHTML = `
                    <h4>${city}</h4>
                    <img src="${iconUrl}" alt="${description}" class="weather-icon">
                    <div class="temp">${temp}°C</div>
                    <div class="description">${description}</div>
                `;
                    })
                    .catch(error => {
                        console.error('Error fetching weather:', error);
                        widget.innerHTML = `<p>Could not load weather. ${error.message}</p>`;
                    });
            }

            // --- Geolocation Logic ---
            if (navigator.geolocation) {
                // (Success) User allowed location
                const successCallback = (position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    fetchWeather(lat, lon);
                };

                // (Error) User blocked or an error occurred
                const errorCallback = (error) => {
                    console.warn(`Geolocation error (${error.code}): ${error.message}`);
                    widget.innerHTML = '<p>Location blocked. Showing default weather.</p>';
                    // Fallback to default city
                    fetchWeather(null, null, 'Manila');
                };

                // Ask the browser for the location
                navigator.geolocation.getCurrentPosition(successCallback, errorCallback);

            } else {
                // Geolocation is not supported by this browser
                widget.innerHTML = '<p>Geolocation not supported. Showing default weather.</p>';
                // Fallback to default city
                fetchWeather(null, null, 'Manila');
            }
        });
        </script>
</body>
</html>


</body>
</html>